exports.id=3699,exports.ids=[3699],exports.modules={7080:()=>{},19119:(a,b,c)=>{"use strict";c.d(b,{_:()=>d});let d=()=>"https://xc2f.com"},40577:()=>{},60843:a=>{function b(a){return Promise.resolve().then(()=>{var b=Error("Cannot find module '"+a+"'");throw b.code="MODULE_NOT_FOUND",b})}b.keys=()=>[],b.resolve=b,b.id=60843,a.exports=b},86508:(a,b,c)=>{"use strict";c.d(b,{A:()=>aB});var d=c(34541),e=c(9288),f=c.n(e),g=c(33873),h=c.n(g),i=c(1355),j=c(79551),k=c(33582),l=c(18154),m=c(57601),n=c(29814);let o=a=>{let b=process.env[a];if(!b)throw Error(`Missing environment variable: ${a}`);return b},p=new n.Z({region:o("AWS_SERVICE_REGION"),credentials:{accessKeyId:o("AWS_ACCESS_KEY"),secretAccessKey:o("AWS_ACCESS_SECRET")}}),q=l.createTransport({SES:{sesClient:p,SendEmailCommand:m.m}});var r=c(49e3);let s=()=>!0,t=({req:{user:a}})=>!!a;var u=c(65407);let v={slug:"categories",access:{create:t,delete:t,read:s,update:t},admin:{useAsTitle:"title"},fields:[{name:"title",type:"text",required:!0},(0,u.O)({position:void 0})]};var w=c(17108),x=c(25721),y=c(79330);let z=(0,j.fileURLToPath)("file:///home/runner/work/www/www/src/collections/Media.ts"),A=h().dirname(z),B={slug:"media",folders:!0,access:{create:t,delete:t,read:s,update:t},admin:{group:"Media"},fields:[{name:"alt",type:"text"},{name:"caption",type:"richText",editor:(0,w.qf)({features:({rootFeatures:a})=>[...a,(0,x.k)(),(0,y.X)()]})}],upload:{staticDir:h().resolve(A,"../../public/media"),adminThumbnail:"thumbnail",focalPoint:!0,imageSizes:[{name:"thumbnail",width:300},{name:"medium",width:900},{name:"large",width:1400},{name:"og",width:1200,height:630,crop:"center"}]}},C=({req:{user:a}})=>!!a||{_status:{equals:"published"}};var D=c(84139);let E={slug:"archive",interfaceName:"ArchiveBlock",fields:[{name:"introContent",type:"richText",editor:(0,w.qf)({features:({rootFeatures:a})=>[...a,(0,D.b)({enabledHeadingSizes:["h1","h2","h3","h4"]}),(0,x.k)(),(0,y.X)()]}),label:"Intro Content"},{name:"populateBy",type:"select",defaultValue:"collection",options:[{label:"Collection",value:"collection"},{label:"Individual Selection",value:"selection"}]},{name:"relationTo",type:"select",admin:{condition:(a,b)=>"collection"===b.populateBy},defaultValue:"posts",label:"Collections To Show",options:[{label:"Posts",value:"posts"}]},{name:"categories",type:"relationship",admin:{condition:(a,b)=>"collection"===b.populateBy},hasMany:!0,label:"Categories To Show",relationTo:"categories"},{name:"limit",type:"number",admin:{condition:(a,b)=>"collection"===b.populateBy,step:1},defaultValue:10,label:"Limit"},{name:"selectedDocs",type:"relationship",admin:{condition:(a,b)=>"selection"===b.populateBy},hasMany:!0,label:"Selection",relationTo:["posts"]}],labels:{plural:"Archives",singular:"Archive"}};function F(a){return"object"==typeof a&&!Array.isArray(a)}function G(a,b){let c={...a};return F(a)&&F(b)&&Object.keys(b).forEach(d=>{F(b[d])&&d in a?c[d]=G(a[d],b[d]):Object.assign(c,{[d]:b[d]})}),c}let H={default:{label:"Default",value:"default"},outline:{label:"Outline",value:"outline"}},I=({appearances:a,disableLabel:b=!1,overrides:c={}}={})=>{let d={name:"link",type:"group",admin:{hideGutter:!0},fields:[{type:"row",fields:[{name:"type",type:"radio",admin:{layout:"horizontal",width:"50%"},defaultValue:"reference",options:[{label:"Internal link",value:"reference"},{label:"Custom URL",value:"custom"}]},{name:"newTab",type:"checkbox",admin:{style:{alignSelf:"flex-end"},width:"50%"},label:"Open in new tab"}]}]},e=[{name:"reference",type:"relationship",admin:{condition:(a,b)=>b?.type==="reference"},label:"Document to link to",relationTo:["pages","posts"],required:!0},{name:"url",type:"text",admin:{condition:(a,b)=>b?.type==="custom"},label:"Custom URL",required:!0}];if(b?d.fields=[...d.fields,...e]:(e.map(a=>({...a,admin:{...a.admin,width:"50%"}})),d.fields.push({type:"row",fields:[...e,{name:"label",type:"text",admin:{width:"50%"},label:"Label",required:!0}]})),!1!==a){let b=[H.default,H.outline];a&&(b=a.map(a=>H[a])),d.fields.push({name:"appearance",type:"select",admin:{description:"Choose how the link should be rendered."},defaultValue:"default",options:b})}return G(d,c)},J=({appearances:a,overrides:b={}}={})=>G({name:"links",type:"array",fields:[I({appearances:a})],admin:{initCollapsed:!0}},b),K={slug:"cta",interfaceName:"CallToActionBlock",fields:[{name:"richText",type:"richText",editor:(0,w.qf)({features:({rootFeatures:a})=>[...a,(0,D.b)({enabledHeadingSizes:["h1","h2","h3","h4"]}),(0,x.k)(),(0,y.X)()]}),label:!1},J({appearances:["default","outline"],overrides:{maxRows:2}})],labels:{plural:"Calls to Action",singular:"Call to Action"}},L=[{name:"size",type:"select",defaultValue:"oneThird",options:[{label:"One Third",value:"oneThird"},{label:"Half",value:"half"},{label:"Two Thirds",value:"twoThirds"},{label:"Full",value:"full"}]},{name:"richText",type:"richText",editor:(0,w.qf)({features:({rootFeatures:a})=>[...a,(0,D.b)({enabledHeadingSizes:["h2","h3","h4"]}),(0,x.k)(),(0,y.X)()]}),label:!1},{name:"enableLink",type:"checkbox"},I({overrides:{admin:{condition:(a,b)=>!!b?.enableLink}}})],M={slug:"formBlock",interfaceName:"FormBlock",fields:[{name:"form",type:"relationship",relationTo:"forms",required:!0},{name:"enableIntro",type:"checkbox",label:"Enable Intro Content"},{name:"introContent",type:"richText",admin:{condition:(a,{enableIntro:b})=>!!b},editor:(0,w.qf)({features:({rootFeatures:a})=>[...a,(0,D.b)({enabledHeadingSizes:["h1","h2","h3","h4"]}),(0,x.k)(),(0,y.X)()]}),label:"Intro Content"}],graphQL:{singularName:"FormBlock"},labels:{plural:"Form Blocks",singular:"Form Block"}},N={slug:"mediaBlock",interfaceName:"MediaBlock",fields:[{name:"media",type:"upload",relationTo:"media",required:!0}]},O={name:"hero",type:"group",fields:[{name:"type",type:"select",defaultValue:"lowImpact",label:"Type",options:[{label:"None",value:"none"},{label:"High Impact",value:"highImpact"},{label:"Medium Impact",value:"mediumImpact"},{label:"Low Impact",value:"lowImpact"}],required:!0},{name:"richText",type:"richText",editor:(0,w.qf)({features:({rootFeatures:a})=>[...a,(0,D.b)({enabledHeadingSizes:["h1","h2","h3","h4"]}),(0,x.k)(),(0,y.X)()]}),label:!1},J({overrides:{maxRows:2}}),{name:"media",type:"upload",admin:{condition:(a,{type:b}={})=>["highImpact","mediumImpact"].includes(b)},relationTo:"media",required:!0}],label:!1},P={posts:"/posts",pages:""},Q=({collection:a,slug:b})=>{if(null==b)return null;let c=encodeURIComponent(b),d=new URLSearchParams({slug:c,collection:a,path:`${P[a]}/${c}`,previewSecret:process.env.PREVIEW_SECRET||""});return`/next/preview?${d.toString()}`};var R=c(97703),S=c(53318),T=c(75018),U=c(67593),V=c(50542),W=c(17803);let X={slug:"pages",access:{create:t,delete:t,read:C,update:t},defaultPopulate:{title:!0,slug:!0},admin:{defaultColumns:["title","slug","updatedAt"],livePreview:{url:({data:a,req:b})=>Q({slug:a?.slug,collection:"pages",req:b})},preview:(a,{req:b})=>Q({slug:a?.slug,collection:"pages",req:b}),useAsTitle:"title"},fields:[{name:"title",type:"text",required:!0},{type:"tabs",tabs:[{fields:[O],label:"Hero"},{fields:[{name:"layout",type:"blocks",blocks:[K,{slug:"content",interfaceName:"ContentBlock",fields:[{name:"columns",type:"array",admin:{initCollapsed:!0},fields:L}]},N,E,M],required:!0,admin:{initCollapsed:!0}}],label:"Content"},{name:"meta",label:"SEO",fields:[(0,S.E)({titlePath:"meta.title",descriptionPath:"meta.description",imagePath:"meta.image"}),(0,T.W)({hasGenerateFn:!0}),(0,U.z)({relationTo:"media"}),(0,V.k)({}),(0,W.r)({hasGenerateFn:!0,titlePath:"meta.title",descriptionPath:"meta.description"})]}]},{name:"publishedAt",type:"date",admin:{position:"sidebar"}},(0,u.O)()],hooks:{afterChange:[({doc:a,previousDoc:b,req:{payload:c,context:d}})=>{if(!d.disableRevalidate){if("published"===a._status){let b="home"===a.slug?"/":`/${a.slug}`;c.logger.info(`Revalidating page at path: ${b}`),(0,R.revalidatePath)(b),(0,R.revalidateTag)("pages-sitemap")}if(b?._status==="published"&&"published"!==a._status){let a="home"===b.slug?"/":`/${b.slug}`;c.logger.info(`Revalidating old page at path: ${a}`),(0,R.revalidatePath)(a),(0,R.revalidateTag)("pages-sitemap")}}return a}],beforeChange:[({data:a,operation:b,req:c})=>{if(("create"===b||"update"===b)&&c.data&&!c.data.publishedAt){let b=new Date;return{...a,publishedAt:b}}return a}],afterDelete:[({doc:a,req:{context:b}})=>{if(!b.disableRevalidate){let b=a?.slug==="home"?"/":`/${a?.slug}`;(0,R.revalidatePath)(b),(0,R.revalidateTag)("pages-sitemap")}return a}]},versions:{drafts:{autosave:{interval:100},schedulePublish:!0},maxPerDoc:50}};var Y=c(51536),Z=c(72253);let $={slug:"banner",fields:[{name:"style",type:"select",defaultValue:"info",options:[{label:"Info",value:"info"},{label:"Warning",value:"warning"},{label:"Error",value:"error"},{label:"Success",value:"success"}],required:!0},{name:"content",type:"richText",editor:(0,w.qf)({features:({rootFeatures:a})=>[...a,(0,x.k)(),(0,y.X)()]}),label:!1,required:!0}],interfaceName:"BannerBlock"},_={slug:"code",interfaceName:"CodeBlock",fields:[{name:"language",type:"select",defaultValue:"typescript",options:[{label:"Typescript",value:"typescript"},{label:"Javascript",value:"javascript"},{label:"CSS",value:"css"}]},{name:"code",type:"code",label:!1,required:!0}]},aa=async({doc:a,req:b,req:{payload:c}})=>{if(a?.authors&&a?.authors?.length>0){let b=[];for(let d of a.authors)try{let e=await c.findByID({id:"object"==typeof d?d?.id:d,collection:"users",depth:0});e&&b.push(e),b.length>0&&(a.populatedAuthors=b.map(a=>({id:a.id,name:a.name})))}catch{}}return a},ab={slug:"posts",access:{create:t,delete:t,read:C,update:t},defaultPopulate:{title:!0,slug:!0,categories:!0,meta:{image:!0,description:!0}},admin:{defaultColumns:["title","slug","updatedAt"],livePreview:{url:({data:a,req:b})=>Q({slug:a?.slug,collection:"posts",req:b})},preview:(a,{req:b})=>Q({slug:a?.slug,collection:"posts",req:b}),useAsTitle:"title"},fields:[{name:"title",type:"text",required:!0,localized:!0},{type:"tabs",tabs:[{fields:[{name:"heroImage",type:"upload",relationTo:"media"},{name:"content",type:"richText",localized:!0,editor:(0,w.qf)({features:({rootFeatures:a})=>[...a,(0,D.b)({enabledHeadingSizes:["h1","h2","h3","h4"]}),(0,Y.Z)({blocks:[$,_,N]}),(0,x.k)(),(0,y.X)(),(0,Z.h)()]}),label:!1,required:!0}],label:"Content"},{fields:[{name:"relatedPosts",type:"relationship",admin:{position:"sidebar"},filterOptions:({id:a})=>({id:{not_in:[a]}}),hasMany:!0,relationTo:"posts"},{name:"categories",type:"relationship",admin:{position:"sidebar"},hasMany:!0,relationTo:"categories"}],label:"Meta"},{name:"meta",label:"SEO",fields:[(0,S.E)({titlePath:"meta.title",descriptionPath:"meta.description",imagePath:"meta.image"}),(0,T.W)({hasGenerateFn:!0}),(0,U.z)({relationTo:"media"}),(0,V.k)({}),(0,W.r)({hasGenerateFn:!0,titlePath:"meta.title",descriptionPath:"meta.description"})]}]},{name:"publishedAt",type:"date",admin:{date:{pickerAppearance:"dayAndTime"},position:"sidebar"},hooks:{beforeChange:[({siblingData:a,value:b})=>"published"!==a._status||b?b:new Date]}},{name:"authors",type:"relationship",admin:{position:"sidebar"},hasMany:!0,relationTo:"users"},{name:"populatedAuthors",type:"array",access:{update:()=>!1},admin:{disabled:!0,readOnly:!0},fields:[{name:"id",type:"text"},{name:"name",type:"text"}]},(0,u.O)()],hooks:{afterChange:[({doc:a,previousDoc:b,req:{payload:c,context:d}})=>{if(!d.disableRevalidate){if("published"===a._status){let b=`/posts/${a.slug}`;c.logger.info(`Revalidating post at path: ${b}`),(0,R.revalidatePath)(b),(0,R.revalidateTag)("posts-sitemap")}if("published"===b._status&&"published"!==a._status){let a=`/posts/${b.slug}`;c.logger.info(`Revalidating old post at path: ${a}`),(0,R.revalidatePath)(a),(0,R.revalidateTag)("posts-sitemap")}}return a}],afterRead:[aa],afterDelete:[({doc:a,req:{context:b}})=>{if(!b.disableRevalidate){let b=`/posts/${a?.slug}`;(0,R.revalidatePath)(b),(0,R.revalidateTag)("posts-sitemap")}return a}]},versions:{drafts:{autosave:{interval:100},schedulePublish:!0},maxPerDoc:50}},ac={slug:"notes",admin:{useAsTitle:"title",group:"Tools"},access:{create:t,read:t,update:t,delete:t},fields:[{name:"title",type:"text",required:!0},{name:"content",type:"blocks",admin:{initCollapsed:!0},blocks:[{slug:"text",fields:[{name:"text",type:"textarea"}]},{slug:"json",fields:[{name:"json",type:"json"}]},_]}],versions:{drafts:!0}},ad={slug:"feeds",access:{create:t,delete:t,read:s,update:t},admin:{useAsTitle:"title",defaultColumns:["title","feedUrl","enabled","_status","updatedAt"],group:"Tools"},fields:[{name:"title",type:"text",required:!0},{name:"feedUrl",type:"text",label:"Feed URL",admin:{readOnly:!0,description:`自动生成，格式为 https://xc2f.com/api/feeds/for/{slug}`}},{name:"enabled",type:"checkbox",defaultValue:!0},{name:"json",type:"json"},{name:"body",type:"textarea",admin:{rows:20}},(0,u.O)({position:void 0})],hooks:{beforeValidate:[({data:a})=>(a?.slug&&(a.feedUrl=`https://xc2f.com/api/feeds/for/${a.slug}${a.json?"?json":""}`),a)]},endpoints:[{path:"/for/:slug",method:"get",handler:async a=>{let b="string"==typeof a.routeParams?.slug?a.routeParams.slug:void 0;if(!b)return Response.json({message:"Slug is required"},{status:400});let{json:c}=a.query,d=a.payload,e=await d.find({collection:"feeds",where:{slug:{equals:b},enabled:{equals:!0},_status:{equals:"published"}},limit:1});if(!e.docs.length)return Response.json({message:"Feed not found"},{status:404});let f=e.docs[0];return void 0!==c?Response.json(f.json??{},{status:200}):new Response(f.body??"",{status:200,headers:{"Content-Type":"text/plain; charset=utf-8"}})}}],versions:{drafts:!0}},ae={slug:"mails",admin:{useAsTitle:"subject",defaultColumns:["subject","to","sendStatus","createdAt"],group:"Tools"},access:{create:t,read:t,update:t,delete:t},fields:[{name:"from",type:"group",required:!0,fields:[{type:"row",fields:[{name:"name",type:"text",defaultValue:process.env.EMAIL_DEFAULT_FROM_NAME},{name:"address",type:"email",required:!0,defaultValue:process.env.EMAIL_DEFAULT_FROM}]}]},{name:"to",type:"array",required:!0,defaultValue:[{address:"",name:""}],fields:[{type:"row",fields:[{name:"address",type:"email",required:!0},{name:"name",type:"text"}]}]},{name:"showAdvanced",type:"checkbox",label:"Show advanced options (cc / bcc / reply-to)",defaultValue:!1},{name:"cc",type:"array",admin:{condition:(a,b)=>b?.showAdvanced},defaultValue:[{address:"",name:""}],fields:[{type:"row",fields:[{name:"address",type:"email"},{name:"name",type:"text"}]}]},{name:"bcc",type:"array",admin:{condition:(a,b)=>b?.showAdvanced},defaultValue:[{address:"",name:""}],fields:[{type:"row",fields:[{name:"address",type:"email"},{name:"name",type:"text"}]}]},{name:"replyTo",type:"email",admin:{condition:(a,b)=>b?.showAdvanced}},{type:"ui",name:"divider-advanced",admin:{components:{Field:"@/components/Divider/index.tsx"}}},{name:"subject",type:"text",required:!0},{name:"text",type:"textarea",admin:{rows:10}},{name:"html",type:"code",admin:{language:"html",description:"HTML content (takes precedence over text)"}},{name:"attachments",type:"array",fields:[{name:"file",type:"upload",relationTo:"media",required:!0}]},{name:"at",type:"date",admin:{position:"sidebar",date:{pickerAppearance:"dayAndTime",displayFormat:"yyyy-MM-dd HH:mm:ss",minDate:new Date}}},{name:"sendStatus",type:"select",defaultValue:"pending",required:!0,options:[{label:"Pending",value:"pending"},{label:"Sent",value:"sent"},{label:"Failed",value:"failed"}],admin:{position:"sidebar"}},{name:"result",type:"textarea",admin:{position:"sidebar",readOnly:!0}}],hooks:{afterChange:[async({doc:a,req:b})=>{let{sendStatus:c,_status:d}=a;if("sent"===c||"draft"===d)return a;await b.payload.jobs.queue({task:"send-email",req:b,input:a,waitUntil:a.at?new Date(a.at):void 0})}]},versions:{drafts:!0}},af={slug:"users",access:{admin:t,create:t,delete:t,read:t,update:t},admin:{defaultColumns:["name","email"],useAsTitle:"name",group:"System"},auth:!0,fields:[{name:"name",type:"text"}],timestamps:!0},ag={slug:"footer",access:{read:()=>!0},fields:[{name:"navItems",type:"array",fields:[I({appearances:!1})],maxRows:6,admin:{initCollapsed:!0,components:{RowLabel:"@/Footer/RowLabel#RowLabel"}}}],hooks:{afterChange:[({doc:a,req:{payload:b,context:c}})=>(c.disableRevalidate||(b.logger.info("Revalidating footer"),(0,R.revalidateTag)("global_footer")),a)]}},ah={slug:"header",access:{read:()=>!0},fields:[{name:"navItems",type:"array",fields:[I({appearances:!1})],maxRows:6,admin:{initCollapsed:!0,components:{RowLabel:"@/Header/RowLabel#RowLabel"}}}],hooks:{afterChange:[({doc:a,req:{payload:b,context:c}})=>(c.disableRevalidate||(b.logger.info("Revalidating header"),(0,R.revalidateTag)("global_header")),a)]}};var ai=c(14829),aj=c(9157),ak=c(89909),al=c(71209),am=c(64158);let an=[{name:"slug",type:"text",index:!0,admin:{readOnly:!0}},{name:"meta",label:"Meta",type:"group",index:!0,admin:{readOnly:!0},fields:[{type:"text",name:"title",label:"Title"},{type:"text",name:"description",label:"Description"},{name:"image",label:"Image",type:"upload",relationTo:"media"}]},{label:"Categories",name:"categories",type:"array",admin:{readOnly:!0},fields:[{name:"relationTo",type:"text"},{name:"categoryID",type:"text"},{name:"title",type:"text"}]}],ao=async({req:a,originalDoc:b,searchDoc:c})=>{let{doc:{relationTo:d}}=c,{slug:e,id:f,categories:g,title:h,meta:i}=b,j={...c,slug:e,meta:{...i,title:i?.title||h,image:i?.image?.id||i?.image,description:i?.description},categories:[]};if(g&&Array.isArray(g)&&g.length>0){let b=[];for(let c of g){if(!c)continue;if("object"==typeof c){b.push(c);continue}let e=await a.payload.findByID({collection:"categories",id:c,disableErrors:!0,depth:0,select:{title:!0},req:a});null!==e?b.push(e):console.error(`Failed. Category not found when syncing collection '${d}' with id: '${f}' to search.`)}j.categories=b.map(a=>({relationTo:"categories",categoryID:String(a.id),title:a.title}))}return j};var ap=c(19119);let aq=[(0,ak.fn)({collections:["pages","posts"],overrides:{admin:{group:"System"},fields:({defaultFields:a})=>a.map(a=>"name"in a&&"from"===a.name?{...a,admin:{description:"You will need to rebuild the website when changing this field."}}:a),hooks:{afterChange:[({doc:a,req:{payload:b}})=>(b.logger.info("Revalidating redirects"),(0,R.revalidateTag)("redirects"),a)]}}}),(0,aj.MK)({collections:["categories"],generateURL:a=>a.reduce((a,b)=>`${a}/${b.slug}`,"")}),(0,al.x)({generateTitle:({doc:a})=>{let b=process.env.SITE_NAME||"XC2F";return a?.title?`${a.title} | ${b}`:b},generateURL:({doc:a})=>{let b=(0,ap._)();return a?.slug?`${b}/${a.slug}`:b}}),(0,ai.jR)({fields:{payment:!1},formOverrides:{admin:{group:"Form"},fields:({defaultFields:a})=>a.map(a=>"name"in a&&"confirmationMessage"===a.name?{...a,editor:(0,w.qf)({features:({rootFeatures:a})=>[...a,(0,x.k)(),(0,D.b)({enabledHeadingSizes:["h1","h2","h3","h4"]})]})}:a)},formSubmissionOverrides:{admin:{group:"Form"}}}),(0,am.u)({collections:["posts"],beforeSync:ao,searchOverrides:{fields:({defaultFields:a})=>[...a,...an]}})];var ar=c(17968),as=c(44717),at=c(62705),au=c(25222),av=c(79095);let aw=(0,w.qf)({features:[(0,ar.$)(),(0,as.D)(),(0,at.k)(),(0,au.v)(),(0,av.T)({enabledCollections:["pages","posts"],fields:({defaultFields:a})=>[...a.filter(a=>!("name"in a)||"url"!==a.name),{name:"url",type:"text",admin:{condition:(a,b)=>b?.linkType!=="internal"},label:({t:a})=>a("fields:enterURL"),required:!0,validate:(a,b)=>b?.siblingData?.linkType==="internal"||!!a||"URL is required"}]})]});var ax=c(67920),ay=c(20797);let az=(0,j.fileURLToPath)("file:///home/runner/work/www/www/src/payload.config.ts"),aA=h().dirname(az),aB=(0,i.f)({admin:{components:{beforeLogin:["@/components/BeforeLogin"],beforeDashboard:["@/components/BeforeDashboard"]},importMap:{baseDir:h().resolve(aA)},user:af.slug,dateFormat:"yyyy-MM-dd HH:mm:ss",livePreview:{breakpoints:[{label:"Mobile",name:"mobile",width:375,height:667},{label:"Tablet",name:"tablet",width:768,height:1024},{label:"Desktop",name:"desktop",width:1440,height:900}]},autoLogin:!1},editor:aw,db:(0,d.V8)({pool:{connectionString:process.env.DATABASE_URL}}),collections:[X,ab,B,v,ac,ad,ae,af],cors:[(0,ap._)()].filter(Boolean),globals:[ah,ag],plugins:[...aq,(0,r.u)({collections:{media:!0},bucket:process.env.S3_BUCKET||"",config:{credentials:{accessKeyId:process.env.S3_ACCESS_KEY_ID||"",secretAccessKey:process.env.S3_SECRET||""},region:process.env.S3_REGION||"auto",endpoint:process.env.S3_ENDPOINT||""}})],secret:process.env.PAYLOAD_SECRET,sharp:f(),typescript:{outputFile:h().resolve(aA,"payload-types.ts")},jobs:{access:{run:({req:a})=>!!a.user||a.headers.get("authorization")===`Bearer ${process.env.CRON_SECRET}`},tasks:[{slug:"send-email",retries:2,handler:async({input:a,req:b})=>{let c=b.payload;if("sent"===(await c.findByID({collection:"mails",id:a.id})).sendStatus)return;let d=a=>{let b=new Date().toISOString();return`${b}
${a}`},e=async()=>{let{attachments:b=[]}=a,d=b.map(a=>a.file?.id||a?.file||a).filter(Boolean);if(!d.length)return[];let e=await c.find({collection:"media",where:{id:{in:d}},limit:b.length});return(e?.docs||[]).filter(a=>a?.url).map(a=>({filename:a.filename,path:`https://xc2f.com${a.url}`,contentType:a.mimeType??"application/octet-stream"}))};try{return await c.sendEmail({...a,attachments:await e()}),await c.update({collection:"mails",id:a.id,data:{sendStatus:"sent",result:d("ok")}}),{output:{emailSent:!0}}}catch(c){throw await b.payload.update({collection:"mails",id:a.id,data:{sendStatus:"failed",result:d(c instanceof Error?c.message:String(c))}}),c}}}],autoRun:[{cron:"* * * * *",limit:100}],jobsCollectionOverrides:({defaultJobsCollection:a})=>(a.admin||(a.admin={}),a.admin.hidden=!1,a)},email:(0,k.y)({defaultFromAddress:process.env.EMAIL_DEFAULT_FROM_NO_REPLY,defaultFromName:process.env.EMAIL_DEFAULT_FROM_NAME,transport:q}),i18n:{supportedLanguages:{en:ax.en,zh:ay.zh}},localization:{locales:[{label:"Chinese",code:"zh"},{label:"English",code:"en"}],defaultLocale:"zh"}})}};